/*
 * Dremio "Messy Data" Challenge: Telecom Network Latency
 * 
 * Scenario: 
 * 5G network pings.
 * 3 Tables: TOWERS (Infra), DEVICES (User), PINGS (Telemetry).
 * 
 * Objective for AI Agent:
 * 1. Join Tables: PINGS -> TOWERS.
 * 2. Geo-Spatial: Distance(Ping_Loc, Tower_Loc).
 * 3. SLA Analysis: Flags pings > 100ms as 'Lag'.
 */

-------------------------------------------------------------------------------
-- 1. SETUP: Create Raw Folder
-------------------------------------------------------------------------------

CREATE FOLDER IF NOT EXISTS Telco_5G;
CREATE FOLDER IF NOT EXISTS Telco_5G.NetOps;

-------------------------------------------------------------------------------
-- 2. DDL: Create Raw Tables (3 Tables)
-------------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS Telco_5G.NetOps.TOWERS (
    TOWER_ID VARCHAR,
    LOCATION_NM VARCHAR,
    LAT DOUBLE,
    LON DOUBLE
);

CREATE TABLE IF NOT EXISTS Telco_5G.NetOps.DEVICES (
    DEVICE_ID VARCHAR,
    MODEL VARCHAR,
    OS_VER VARCHAR
);

CREATE TABLE IF NOT EXISTS Telco_5G.NetOps.PINGS (
    PING_ID VARCHAR,
    DEVICE_ID VARCHAR,
    TOWER_ID VARCHAR,
    TS TIMESTAMP,
    LATENCY_MS INT,
    SIGNAL_DBM INT
);

-------------------------------------------------------------------------------
-- 3. SEED DATA (50+ Records)
-------------------------------------------------------------------------------

-- TOWERS
INSERT INTO Telco_5G.NetOps.TOWERS VALUES
('T-1', 'Downtown', 40.0, -74.0), ('T-2', 'Uptown', 40.1, -74.0);

-- DEVICES
INSERT INTO Telco_5G.NetOps.DEVICES VALUES
('D-1', 'iPhone 15', 'iOS 18'), ('D-2', 'Pixel 9', 'Android 15');

-- PINGS (50 Rows)
INSERT INTO Telco_5G.NetOps.PINGS VALUES
('P-1', 'D-1', 'T-1', '2023-01-01 10:00:00', 10, -50),
('P-2', 'D-1', 'T-1', '2023-01-01 10:00:01', 12, -52),
('P-3', 'D-1', 'T-1', '2023-01-01 10:00:02', 200, -90), -- Lag
('P-4', 'D-1', 'T-1', '2023-01-01 10:00:03', 500, -100), -- Drop
('P-5', 'D-1', 'T-1', '2023-01-01 10:00:04', 10, -50),
('P-6', 'D-2', 'T-1', '2023-01-01 10:00:00', 15, -60),
('P-7', 'D-2', 'T-1', '2023-01-01 10:00:01', 15, -60),
('P-8', 'D-2', 'T-2', '2023-01-01 10:00:02', 15, -60),
('P-9', 'D-2', 'T-2', '2023-01-01 10:00:03', 15, -60),
('P-10', 'D-2', 'T-2', '2023-01-01 10:00:04', 15, -60),
('P-11', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-12', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-13', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-14', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-15', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-16', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-17', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-18', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-19', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-20', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-21', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-22', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-23', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-24', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-25', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-26', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-27', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-28', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-29', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-30', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-31', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-32', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-33', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-34', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-35', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-36', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-37', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-38', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-39', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-40', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-41', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-42', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-43', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-44', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-45', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-46', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-47', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-48', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-49', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50),
('P-50', 'D-1', 'T-1', '2023-01-01 10:01:00', 10, -50);

-------------------------------------------------------------------------------
-- 4. EXAMPLE AI AGENT PROMPT
-------------------------------------------------------------------------------
/*
 * Prompt to Copy/Paste into Dremio AI:
 * "Monitor 5G latency in Telco_5G.NetOps.
 *  
 *  1. Bronze: Raw View of PINGS, TOWERS, DEVICES.
 *  2. Silver: 
 *     - Join: PINGS -> TOWERS and DEVICES.
 *     - Categorize: 'Good' (<20ms), 'Fair' (20-100ms), 'Poor' (>100ms).
 *  3. Gold: 
 *     - Tower Health: % of 'Poor' pings per Tower.
 *  
 *  Show the SQL."
 */
