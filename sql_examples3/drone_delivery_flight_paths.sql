/*
 * Dremio "Messy Data" Challenge: Drone Delivery Flight Paths
 * 
 * Scenario: 
 * Drone telemetry.
 * 3 Tables: DRONES (Device), ORDERS (Mission), TELEMETRY (GPS).
 * 
 * Objective for AI Agent:
 * 1. Join Tables: TELEMETRY -> DRONES.
 * 2. Geo-Fencing: Check Lat/Lon bounds.
 * 3. Distance: Sum(Distance between pings) per Order.
 */

-------------------------------------------------------------------------------
-- 1. SETUP: Create Raw Folder
-------------------------------------------------------------------------------

CREATE FOLDER IF NOT EXISTS Sky_Net;
CREATE FOLDER IF NOT EXISTS Sky_Net.Logistics;

-------------------------------------------------------------------------------
-- 2. DDL: Create Raw Tables (3 Tables)
-------------------------------------------------------------------------------

CREATE TABLE IF NOT EXISTS Sky_Net.Logistics.DRONES (
    DRONE_ID VARCHAR,
    MODEL VARCHAR,
    BATTERY_CAPACITY_WH INT
);

CREATE TABLE IF NOT EXISTS Sky_Net.Logistics.ORDERS (
    ORDER_ID VARCHAR,
    DRONE_ID VARCHAR,
    DESTINATION VARCHAR,
    PRIORITY VARCHAR
);

CREATE TABLE IF NOT EXISTS Sky_Net.Logistics.TELEMETRY (
    PING_ID VARCHAR,
    DRONE_ID VARCHAR,
    TS TIMESTAMP,
    LAT DOUBLE,
    LON DOUBLE,
    ALTITUDE DOUBLE
);

-------------------------------------------------------------------------------
-- 3. SEED DATA (50+ Records)
-------------------------------------------------------------------------------

-- DRONES
INSERT INTO Sky_Net.Logistics.DRONES VALUES
('D-1', 'Quadcopter', 1000), ('D-2', 'Hexacopter', 2000), ('D-3', 'FixedWing', 5000);

-- ORDERS
INSERT INTO Sky_Net.Logistics.ORDERS VALUES
('O-1', 'D-1', '123 Main St', 'High'), ('O-2', 'D-2', '456 Oak St', 'Standard');

-- TELEMETRY (50 Rows)
INSERT INTO Sky_Net.Logistics.TELEMETRY VALUES
('P-1', 'D-1', '2023-01-01 10:00:00', 40.7128, -74.0060, 100.0), -- NYC
('P-2', 'D-1', '2023-01-01 10:00:05', 40.7129, -74.0061, 105.0),
('P-3', 'D-1', '2023-01-01 10:00:10', 40.7130, -74.0062, 110.0),
('P-4', 'D-1', '2023-01-01 10:00:15', 40.7131, -74.0063, 115.0),
('P-5', 'D-1', '2023-01-01 10:00:20', 40.7132, -74.0064, 120.0),
('P-6', 'D-1', '2023-01-01 10:00:25', 40.7133, -74.0065, 125.0),
('P-7', 'D-1', '2023-01-01 10:00:30', 40.7134, -74.0066, 130.0),
('P-8', 'D-1', '2023-01-01 10:00:35', 40.7135, -74.0067, 135.0),
('P-9', 'D-1', '2023-01-01 10:00:40', 40.7136, -74.0068, 140.0),
('P-10', 'D-1', '2023-01-01 10:00:45', 40.7137, -74.0069, 145.0),
('P-11', 'D-2', '2023-01-01 11:00:00', 34.0522, -118.2437, 200.0), -- LA
('P-12', 'D-2', '2023-01-01 11:00:05', 34.0523, -118.2438, 200.0),
('P-13', 'D-2', '2023-01-01 11:00:10', 34.0524, -118.2439, 200.0),
('P-14', 'D-2', '2023-01-01 11:00:15', 34.0525, -118.2440, 200.0),
('P-15', 'D-2', '2023-01-01 11:00:20', 34.0526, -118.2441, 195.0), -- Drop
('P-16', 'D-2', '2023-01-01 11:00:25', 0.0, 0.0, 0.0), -- Null Island Error
('P-17', 'D-2', '2023-01-01 11:00:30', 34.0528, -118.2443, 190.0),
('P-18', 'D-3', '2023-01-01 12:00:00', 51.5074, -0.1278, 500.0), -- London
('P-19', 'D-3', '2023-01-01 12:00:05', 51.5075, -0.1279, 500.0),
('P-20', 'D-3', '2023-01-01 12:00:10', NULL, NULL, 500.0),
('P-21', 'D-1', '2023-01-01 10:01:00', 40.7140, -74.0070, 150.0),
('P-22', 'D-1', '2023-01-01 10:01:05', 40.7141, -74.0071, 150.0),
('P-23', 'D-1', '2023-01-01 10:01:10', 40.7142, -74.0072, 150.0),
('P-24', 'D-1', '2023-01-01 10:01:15', 40.7143, -74.0073, 150.0),
('P-25', 'D-1', '2023-01-01 10:01:20', 40.7144, -74.0074, 150.0),
('P-26', 'D-1', '2023-01-01 10:01:25', 40.7145, -74.0075, 150.0),
('P-27', 'D-1', '2023-01-01 10:01:30', 40.7146, -74.0076, 150.0),
('P-28', 'D-1', '2023-01-01 10:01:35', 40.7147, -74.0077, 150.0),
('P-29', 'D-1', '2023-01-01 10:01:40', 40.7148, -74.0078, 150.0),
('P-30', 'D-1', '2023-01-01 10:01:45', 40.7149, -74.0079, 150.0),
('P-31', 'D-2', '2023-01-01 11:01:00', 34.0530, -118.2450, 200.0),
('P-32', 'D-2', '2023-01-01 11:01:05', 34.0531, -118.2451, 200.0),
('P-33', 'D-2', '2023-01-01 11:01:10', 34.0532, -118.2452, 200.0),
('P-34', 'D-2', '2023-01-01 11:01:15', 34.0533, -118.2453, 200.0),
('P-35', 'D-2', '2023-01-01 11:01:20', 34.0534, -118.2454, 200.0),
('P-36', 'D-2', '2023-01-01 11:01:25', 34.0535, -118.2455, 200.0),
('P-37', 'D-2', '2023-01-01 11:01:30', 34.0536, -118.2456, 200.0),
('P-38', 'D-2', '2023-01-01 11:01:35', 34.0537, -118.2457, 200.0),
('P-39', 'D-2', '2023-01-01 11:01:40', 34.0538, -118.2458, 200.0),
('P-40', 'D-2', '2023-01-01 11:01:45', 34.0539, -118.2459, 200.0),
('P-41', 'D-3', '2023-01-01 12:01:00', 51.5080, -0.1280, 500.0),
('P-42', 'D-3', '2023-01-01 12:01:05', 51.5081, -0.1281, 500.0),
('P-43', 'D-3', '2023-01-01 12:01:10', 51.5082, -0.1282, 500.0),
('P-44', 'D-3', '2023-01-01 12:01:15', 51.5083, -0.1283, 500.0),
('P-45', 'D-3', '2023-01-01 12:01:20', 51.5084, -0.1284, 500.0),
('P-46', 'D-3', '2023-01-01 12:01:25', 51.5085, -0.1285, 500.0),
('P-47', 'D-3', '2023-01-01 12:01:30', 51.5086, -0.1286, 500.0),
('P-48', 'D-3', '2023-01-01 12:01:35', 51.5087, -0.1287, 500.0),
('P-49', 'D-3', '2023-01-01 12:01:40', 51.5088, -0.1288, 500.0),
('P-50', 'D-3', '2023-01-01 12:01:45', 51.5089, -0.1289, 500.0);

-------------------------------------------------------------------------------
-- 4. EXAMPLE AI AGENT PROMPT
-------------------------------------------------------------------------------
/*
 * Prompt to Copy/Paste into Dremio AI:
 * "Track drone flights in Sky_Net.Logistics.
 *  
 *  1. Bronze: Raw View of TELEMETRY, ORDERS, DRONES.
 *  2. Silver: 
 *     - Join: TELEMETRY -> DRONES.
 *     - Filter: Remove Lat/Lon = 0.0 (GPS Error).
 *  3. Gold: 
 *     - Max Altitude: Show max altitude per Drone per Day.
 *  
 *  Show the SQL."
 */
